<div class="forgot-page">
  <div class="forgot-card">
    <h2 class="forgot-title">Redefinir senha</h2>

    <p class="forgot-desc">Insira o token recebido por e‑mail e escolha uma nova senha.</p>

    <form (ngSubmit)="submit()" [formGroup]="form" novalidate class="forgot-form">
      <input formControlName="token" placeholder="Token recebido por e‑mail" class="form-input" />
      <input type="password" formControlName="newPassword" placeholder="Nova senha (mínimo 6 caracteres)" class="form-input" />
      <input type="password" formControlName="confirmPassword" placeholder="Confirme a nova senha" class="form-input" />

      <!-- safe access to mismatch to avoid TS4111 -->
      <div *ngIf="form.errors && form.errors['mismatch']" class="error">As senhas não coincidem.</div>

      <div class="actions">
        <button type="submit" class="btn-primary" [disabled]="loading || form.invalid">
          {{ loading ? 'Aguarde...' : 'Alterar senha' }}
        </button>

        <a routerLink="/auth/login" class="btn-link">Voltar ao login</a>
      </div>
    </form>

    <div *ngIf="successMessage" class="info">{{ successMessage }}</div>
    <div *ngIf="errorMessage" class="error">{{ errorMessage }}</div>
  </div>
</div>