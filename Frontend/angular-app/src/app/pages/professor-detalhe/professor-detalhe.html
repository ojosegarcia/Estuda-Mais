<div *ngIf="professor$ | async as professor" class="profile-container">

  <header class="profile-header">
    <div class="professor-avatar-large">
      <span class="avatar-initials">{{ getInitials(professor.nomeCompleto) }}</span>
    </div>
    <div class="profile-header-info">
      <h1>{{ professor.nomeCompleto }}</h1>
      <div class="profile-tags">
        <span *ngFor="let materia of professor.materias" class="materia-tag">
          {{ materia.nome }}
        </span>
      </div>
    </div>
    <div class="profile-header-actions">
      <span class="profile-preco">R$ {{ professor.valorHora }}/hora</span>
    </div>
  </header>

  <div class="profile-body">

    <div class="profile-main">
      <section>
        <h2>Sobre Mim</h2>
        <p>{{ professor.sobre }}</p>
      </section>

      <section *ngIf="professor.metodologia">
        <h2>ğŸ“– Metodologia de Ensino</h2>
        <p>{{ professor.metodologia }}</p>
      </section>

      <section>
        <h2>ğŸ’¼ ExperiÃªncia Profissional</h2>
        <ul class="experiencia-lista" *ngIf="experiencias && experiencias.length > 0">
          <li *ngFor="let exp of experiencias" class="exp-item">
            <strong class="exp-cargo">{{ exp.cargo }}</strong>
            <span class="exp-instituicao">{{ exp.instituicao }}</span>
            <span class="exp-periodo">{{ exp.periodo }}</span>
            <p class="exp-descricao" *ngIf="exp.descricao">{{ exp.descricao }}</p>
          </li>
        </ul>
        <p class="empty-message" *ngIf="!experiencias || experiencias.length === 0">
          ğŸ“š Este professor ainda nÃ£o adicionou experiÃªncias profissionais.
        </p>
      </section>

      <section>
        <h2>ğŸ† Conquistas e Certificados</h2>
        <ul class="conquista-lista" *ngIf="conquistas && conquistas.length > 0">
          <li *ngFor="let conquista of conquistas" class="conquista-item">
            <strong class="conquista-titulo">{{ conquista.tituloConquista }}</strong>
            <span class="conquista-ano">{{ conquista.ano }}</span>
            <p class="conquista-descricao" *ngIf="conquista.descricao">{{ conquista.descricao }}</p>
          </li>
        </ul>
        <p class="empty-message" *ngIf="!conquistas || conquistas.length === 0">
          ğŸ¯ Este professor ainda nÃ£o adicionou conquistas ou certificados.
        </p>
      </section>
    </div>

    <aside class="profile-sidebar">
      <section>
        <h2>ğŸ“… Agendar Aula</h2>
        
        <div class="date-picker">
          <label for="data-aula">1ï¸âƒ£ Escolha uma data:</label>
          <input 
            type="date" 
            id="data-aula" 
            class="info-value"
            (change)="onDataSelecionada($event)"
            [min]="today" >
          
          <div *ngIf="dataSelecionada" class="data-selecionada-info">
            <span class="info-icon">ğŸ“†</span>
            <span class="info-text">{{ formatarData(dataSelecionada) }} ({{ getDiaLabel(getDiaDaSemana(dataSelecionada)) }})</span>
          </div>
        </div>
        
        <div class="horarios-container" *ngIf="dataSelecionada">
          <label>2ï¸âƒ£ Escolha um horÃ¡rio disponÃ­vel:</label>

          <div *ngIf="isLoadingSlots" class="loading-slots">
            <p>â³ Buscando horÃ¡rios disponÃ­veis...</p>
          </div>

          <div *ngIf="!isLoadingSlots && slotsFiltrados.length > 0" class="horarios-grid">
            <button 
              *ngFor="let slot of slotsFiltrados"
              class="horario-slot"
              (click)="agendarSlot(slot)">
              {{ slot }}
            </button>
          </div>

          <div *ngIf="!isLoadingSlots && slotsFiltrados.length === 0" class="empty-slots">
            <p>âŒ Nenhum horÃ¡rio disponÃ­vel para este dia.</p>
            <p style="margin-top: 0.5rem; font-size: 0.85rem;">Tente outra data ou entre em contato com o professor.</p>
          </div>
        </div>

        <div class="empty-disponibilidades" *ngIf="!dataSelecionada && !isLoadingSlots">
          <p>ğŸ‘† Selecione uma data no calendÃ¡rio acima para ver os horÃ¡rios disponÃ­veis.</p>
        </div>
      </section>
      
      <section>
        <h2>â­ AvaliaÃ§Ãµes</h2>
        <p>(Em breve)</p>
      </section>
    </aside>
  </div>

</div>