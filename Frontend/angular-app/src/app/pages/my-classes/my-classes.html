<div class="my-classes-container">
  <div class="page-header">
    <h1 class="page-title">
      <span class="icon">📅</span>
      Minhas Aulas
    </h1>
    <p class="page-subtitle" *ngIf="currentUser">
      {{ isProfessor() ? 'Gerencie suas aulas agendadas' : 'Acompanhe suas aulas marcadas' }}
    </p>
  </div>

  <div *ngIf="isLoading" class="loading-state">
    <p>Carregando...</p>
  </div>

  <ng-container *ngIf="aulas$ | async as aulas">

    <div class="classes-content" *ngIf="isAluno()">
      
      <div class="empty-state" *ngIf="aulas.length === 0 && !isLoading">
        <div class="empty-icon">📚</div>
        <h3>Nenhuma aula agendada</h3>
        <p>Você ainda não tem aulas marcadas.</p>
        <a routerLink="/home" class="btn-primary">Encontrar Professores</a>
      </div>

      <div class="classes-grid" *ngIf="aulas.length > 0">
        <div class="class-card" *ngFor="let aula of aulas" [ngClass]="getStatusClass(aula.statusAula)">
          <div class="card-header">
            <h3 class="class-subject">
              <span class="subject-icon">📚</span>
              {{ getMateriaNome(aula) }}
            </h3>
            <span class="status-badge" [ngClass]="getStatusClass(aula.statusAula)">
              {{ getStatusLabel(aula.statusAula) }}
            </span>
          </div>
          
          <div class="card-body">
            <div class="info-row">
              <span class="info-icon">👨‍🏫</span>
              <span>{{ getProfessorNome(aula) }}</span>
            </div>
            <div class="info-row">
              <span class="info-icon">📅</span>
              <span>{{ formatarData(aula.dataAula) }}</span>
            </div>
            <div class="info-row">
              <span class="info-icon">🕐</span>
              <span>{{ aula.horarioInicio }} - {{ aula.horarioFim }}</span>
            </div>
          </div>

          <div class="card-footer" *ngIf="aula.statusAula === 'SOLICITADA' || aula.statusAula === 'CONFIRMADA'">
            <button class="btn-danger btn-sm" (click)="cancelarAula(aula.id)">
              ❌ Cancelar Aula
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="classes-content" *ngIf="isProfessor()">
      
      <div class="stats-summary">
        <div class="stat-card"><div class="stat-number">{{ totalAulas }}</div><div class="stat-label">Total de Aulas</div></div>
        <div class="stat-card"><div class="stat-number">{{ aulasConfirmadas }}</div><div class="stat-label">Confirmadas</div></div>
        <div class="stat-card"><div class="stat-number">{{ aulasPendentes }}</div><div class="stat-label">Pendentes</div></div>
      </div>

      <div class="empty-state" *ngIf="aulas.length === 0 && !isLoading">
        <div class="empty-icon">🔔</div>
        <h3>Nenhuma solicitação de aula</h3>
        <p>Você ainda não tem aulas na sua agenda.</p>
      </div>

      <div class="classes-list" *ngIf="aulas.length > 0">
        <div class="class-item" *ngFor="let aula of aulas" [ngClass]="getStatusClass(aula.statusAula)">
          <div class="item-left">
            <div class="student-avatar">
              <span>{{ getIniciais(getAlunoNome(aula)) }}</span>
            </div>
            <div class="item-info">
              <h4 class="student-name">{{ getAlunoNome(aula) }}</h4>
              <p class="class-details">
                <span class="subject-tag">📚 {{ getMateriaNome(aula) }}</span>
                <span class="separator">•</span>
                <span>{{ formatarData(aula.dataAula) }} às {{ aula.horarioInicio }}</span>
              </p>
            </div>
          </div>

          <div class="item-right">
            <span class="status-badge" [ngClass]="getStatusClass(aula.statusAula)">
              {{ getStatusLabel(aula.statusAula) }}
            </span>
            
            <div class="action-buttons" *ngIf="aula.statusAula === 'SOLICITADA'">
              <button class="btn-icon btn-success" (click)="confirmarAula(aula.id)" title="Confirmar Aula">✔️</button>
              <button class="btn-icon btn-danger" (click)="recusarAula(aula.id)" title="Recusar Aula">❌</button>
            </div>

            <div class="action-buttons" *ngIf="aula.statusAula === 'CONFIRMADA'">
              <button class="btn-icon btn-danger" (click)="cancelarAula(aula.id)" title="Cancelar Aula">❌</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </ng-container>
</div>